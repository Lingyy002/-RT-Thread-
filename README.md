---

# 📡 校园智能巡逻机器人系统（基于RT-Thread + STM32 + K230）

## 📘 项目简介

本项目设计并实现了一套基于 RT-Thread 实时操作系统的**校园智能巡逻机器人系统**，集成了路径规划、自主导航、视觉识别、远程通信和多功能安全预警能力，具备良好的实用性和扩展性。机器人采用麦克纳姆轮底盘，能实现全向移动控制，适应复杂校园地形。

系统结合 **STM32F407VET6** 为主控核心，**K230 平台**部署 YOLOv8 模型用于边缘识别，GPS 实现定位，LoRa 实现低功耗远距离通信，同时调用百度地图 API 完成巡逻路径规划。

---

## 🔧 系统功能

* 🚗 自主导航与路径规划（GPS + 百度地图 API）
* 🔥 火灾检测（YOLOv8 + K230）
* 🧍 人群聚集识别
* 🚪 教室门未关闭识别
* 📡 LoRa 通信（上传报警/位置信息至上位机）
* 🧭 麦克纳姆轮底盘全向移动控制
* ⏱ 实时任务调度（基于 RT-Thread）

---

## 🖼 系统结构图

```
┌────────────┐     ┌────────────┐     ┌────────────┐
│  百度地图API │ ←→ │  主控 STM32 │ ←→ │  K230视觉模块 │
└────────────┘     │ (RT-Thread)│     └────────────┘
      ▲            └────┬───────┘            │
      │                 ▼                    ▼
┌────────────┐   ┌────────────┐        ┌────────────┐
│   GPS模块   │   │  LoRa通信模块 │        │ 麦克纳姆轮控制 │
└────────────┘   └────────────┘        └────────────┘
```

---

## 💻 软件架构

### 1. RT-Thread 多线程任务设计

* `gps_thread`：解析 NMEA 数据获取经纬度
* `motor_thread`：根据导航状态控制麦克纳姆轮移动
* `lora_thread`：发送告警/位置信息至 PC/云端
* `vision_thread`：串口接收 K230 推理结果

### 2. K230 YOLOv8 模型部署

* 采用 SOPHGO 提供的 kmodel 格式
* 支持 3 类识别：火焰、人群、门开
* SPI/UART 输出识别结果至主控

---

## ⚙️ 硬件环境

| 模块     | 型号/平台          |
| ------ | -------------- |
| 主控 MCU | STM32F407VET6  |
| 操作系统   | RT-Thread      |
| 视觉识别平台 | K230    |
| 通信模块   | LoRa SX1278    |
| 定位模块   | GPS YB-MVV21 |
| 驱动模块   | 麦克纳姆轮 + 电调     |
| 电源     | 12V 锂电池        |

---

## 🌐 外部依赖

* 百度地图开放平台 API：[https://lbsyun.baidu.com/](https://lbsyun.baidu.com/)
* YOLOv8 模型（ultralytics）转换为 kmodel 格式
* SDK 工具链（用于 K230 编译）

---

## 🚀 快速部署说明

### 🔌 硬件连接

* GPS → STM32（USART）
* LoRa → STM32（USART）
* K230 → STM32（UART 或 SPI）
* 电机驱动 → STM32（PWM）

### 🧪 使用步骤

1. 烧录 STM32 固件（含 RT-Thread）
2. 烧录 K230 固件并加载 kmodel
3. 确保 GPS 定位正常，LoRa 上位机在线
4. 运行系统，观察巡逻路径与识别响应
---

## 🏁 项目状态与展望

✅ 当前完成：

* 主控通信 + 视觉识别 + 路径导航基本功能
* LoRa 报警信息成功回传

🔜 未来扩展：

* 加入语音播报、人脸识别、障碍避障
* 多机组网协同巡逻
* Wi-Fi 视频推流与远程控制面板

---
